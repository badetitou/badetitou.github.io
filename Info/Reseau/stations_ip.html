<!DOCTYPE html>
<html>
<head>
    <title>Stations IP4</title>
    <meta charset="UTF-8">

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <script src="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.js"></script>


    <link href="reseau.css" rel="stylesheet" type="text/css">
    <link href="jquery-ui-1.11.4/jquery-ui.css" rel="stylesheet" type="text/css">

    <script src="jquery-2.2.2.min.js"></script>
    <script src="jquery-ui-1.11.4/jquery-ui.js"></script>
    <script src="reseau.js"></script>
    <script src="badetitou.js"></script>
</head>
<body onLoad="init(); main();">
<script>

    function init() {
        $("#formip4").load("formip4.html");
        $("#formether").load("formether.html");
        elements = [$('#station1'), $('#station2')];
        connexions = [
            {'objet1': $('#station1_interface1'), 'objet2': $('#station2_interface1')},
        ];
    };
</script>
<!-- TODO Changer IPV6 par address mac -->

<!-- Ajout de station dialog -->
<dialog class="mdl-dialog dialog_station">
    <div class="mdl-dialog__title">
        Ajout Station
    </div>
    <div class="mdl-dialog__content">
        <p>
            Entrez l'ensemble des informations d'une station.
        </p>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_station_route_address_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_station_route_address_1">Route Adresse </label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_station_route_masque_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_station_route_masque_1">Route Masque</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_station_route_passerelle_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_station_route_passerelle_1">Route Passerelle</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--primary add_route_position dialog_station">
            Ajouter
        </button>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_station_portIp6" pattern="^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$">
            <label class="mdl-textfield__label" for="ask_station_portIp6">Not address mac</label>
            <span class="mdl-textfield__error">Not IPV6 address</span>

        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_station_portIp4" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_station_portIp4">Adresse port Ip4</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>

        </div>
    </div>
    <div class="mdl-dialog__actions">
        <button type="button" class="mdl-button mdl-js-button mdl-button--primary valider dialog_station">Valider</button>
        <button type="button" class="mdl-button mdl-js-button mdl-button--primary abandon dialog_station">Abandon</button>
    </div>
</dialog>


<!-- Ajout de Routeur dialog -->
<dialog class="mdl-dialog dialog_routeur">
    <div class="mdl-dialog__title">
        Ajout Routeur
    </div>
    <div class="mdl-dialog__content">
        <p>
            Entrez l'ensemble des informations d'un Routeur.
        </p>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_routeur_route_address_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_routeur_route_address_1">Route Adresse </label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_routeur_route_masque_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_routeur_route_masque_1">Route Masque</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_routeur_route_passerelle_1" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_routeur_route_passerelle_1">Route Passerelle</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--primary add_route_position dialog_routeur">
            Ajouter
        </button>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_routeur_portIp6" pattern="^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$">
            <label class="mdl-textfield__label" for="ask_routeur_portIp6">Not address mac</label>
            <span class="mdl-textfield__error">Not IPV6 address</span>

        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input class="mdl-textfield__input" type="text" id="ask_routeur_portIp4" pattern="((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}">
            <label class="mdl-textfield__label" for="ask_routeur_portIp4">Adresse port Ip4</label>
            <span class="mdl-textfield__error">Not IPV4 address</span>

        </div>
        <button class="mdl-button mdl-js-button mdl-button--primary add_port_position dialog_routeur">
            Ajouter
        </button>
    </div>
    <div class="mdl-dialog__actions">
        <button type="button" class="mdl-button mdl-js-button mdl-button--primary valider dialog_routeur">Valider</button>
        <button type="button" class="mdl-button mdl-js-button mdl-button--primary abandon dialog_routeur">Abandon</button>
    </div>
</dialog>

<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect show-modal dialog_station" style="position: fixed;right: 12px;bottom: 12px;z-index: 3">
    Ajouter Station
</button>

<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect show-modal dialog_routeur" style="position: fixed;right: 12px;bottom: 60px;z-index: 3">
    Ajouter Routeur
</button>

<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect show-modal-connection" style="position: fixed;left: 12px;bottom: 12px;z-index: 3">
    Connections
</button>

<!-- Script for add station -->
<script>
    var dialog_station = document.querySelector('dialog.dialog_station');
    var showModalButton_routeur = document.querySelector('.show-modal.dialog_station');
    if (! dialog_station.showModal) {
        dialogPolyfill.registerDialog(dialog_station);
    }
    showModalButton_routeur.addEventListener('click', function() {
        nbRoutage = 1;
        dialog_station.showModal();
    });
    dialog_station.querySelector('.abandon.dialog_station').addEventListener('click', function() {
        dialog_station.close();
        remove_route_position("station");
        nbRoutage = 1;
    });
    dialog_station.querySelector('.add_route_position.dialog_station').addEventListener('click', function () {
        add_route_position("station");
    });
    dialog_station.querySelector('.valider.dialog_station').addEventListener('click', function () {
        dialog_station.close();
        var tabRouteAdresse = [];
        var tabRouteMasque = [];
        var tabRoutePasserelle = [];
        for (var i = 1; i <= nbRoutage; ++i) {
            tabRouteAdresse.push($("#ask_station_route_address_"+i+"").val());
            tabRouteMasque.push($("#ask_station_route_masque_"+i+"").val());
            tabRoutePasserelle.push($("#ask_station_route_passerelle_"+i+"").val());
        }
        addStation(tabRouteAdresse, tabRouteMasque, tabRoutePasserelle, $("#ask_station_portIp6").val(),$("#ask_station_portIp4").val());
        remove_route_position("station");
        nbRoutage = 1;
    })
</script>

<!-- Script for add routeur -->
<script>
    var dialog_routeur = document.querySelector('dialog.dialog_routeur');
    var showModalButton_routeur = document.querySelector('.show-modal.dialog_routeur');
    if (! dialog_routeur.showModal) {
        dialogPolyfill.registerDialog(dialog_routeur);
    }
    showModalButton_routeur.addEventListener('click', function() {
        nbRoutage = 1;
        dialog_routeur.showModal();
    });
    dialog_routeur.querySelector('.abandon.dialog_routeur').addEventListener('click', function() {
        dialog_routeur.close();
        remove_route_position("routeur");
        nbRoutage = 1;
    });
    dialog_routeur.querySelector('.add_route_position.dialog_routeur').addEventListener('click', function () {
        add_route_position("routeur");
    });
    dialog_routeur.querySelector('.add_port_position.dialog_routeur').addEventListener('click', function () {
        add_port_position("routeur");
    });
    dialog_routeur.querySelector('.valider.dialog_routeur').addEventListener('click', function () {
        dialog_routeur.close();
        var tabRouteAdresse = [];
        var tabRouteMasque = [];
        var tabRoutePasserelle = [];
        for (var i = 1; i <= nbRoutage; ++i) {
            tabRouteAdresse.push($("#ask_routeur_route_address_"+i+"").val());
            tabRouteMasque.push($("#ask_routeur_route_masque_"+i+"").val());
            tabRoutePasserelle.push($("#ask_routeur_route_passerelle_"+i+"").val());
        }
        addRouteur(tabRouteAdresse, tabRouteMasque, tabRoutePasserelle, $("#ask_station_portIp6").val(),$("#ask_station_portIp4").val());
        remove_route_position("routeur");
        nbRoutage = 1;
    })
</script>

<div class="station" id="station1" style="bottom: 250px; left: 230px;">
    <div class="nom">Station 1</div>
    <div class="cadre_titre" onClick="table_toggle($('#station1_table'));">Table de routage</div>
    <div class="tableroutage" id="station1_table">
        <div class="route">
            <div class="route_adresse">192.168.1.0</div>
            <div class="route_masque">255.255.255.0</div>
            <div class="route_passerelle">0.0.0.0</div>
        </div>
        <div class="route">
            <div class="route_adresse">0.0.0.0</div>
            <div class="route_masque">0.0.0.0</div>
            <div class="route_passerelle">192.168.1.1</div>
        </div>
    </div>
    <div class="cadre_titre" onClick="table_toggle($('#station1_arp'));">Cache ARP</div>
    <div class="cachearp" id="station1_arp"></div>
    <div class="cadre_titre" onClick="table_toggle($('#station1_paquets'));">Paquets reçus</div>
    <div class="paquets fantome" id="station1_paquets"></div>
    <div class="ports" id="station1_interfaces">
        <div class="port" id="station1_interface1">
            <div class="ethport">00:11:11:11:11:01</div>
            <div class="ip4port">192.168.1.100</div>
        </div>
    </div>
</div>

<div class="station" id="station2" style="bottom: 0px; left: 400px;">
    <div class="nom">Station 2</div>
    <div class="cadre_titre" onClick="table_toggle($('#station2_table'));">Table de routage</div>
    <div class="tableroutage" id="station2_table">
        <div class="route">
            <div class="route_adresse">192.168.2.0</div>
            <div class="route_masque">255.255.255.0</div>
            <div class="route_passerelle">0.0.0.0</div>
        </div>
        <div class="route">
            <div class="route_adresse">0.0.0.0</div>
            <div class="route_masque">0.0.0.0</div>
            <div class="route_passerelle">192.168.2.1</div>
        </div>
    </div>
    <div class="cadre_titre" onClick="table_toggle($('#station2_arp'));">Cache ARP</div>
    <div class="cachearp" id="station2_arp"></div>
    <div class="cadre_titre" onClick="table_toggle($('#station2_paquets'));">Paquets reçus</div>
    <div class="paquets fantome" id="station2_paquets"></div>
    <div class="ports" id="station2_interfaces">
        <div class="port" id="station2_interface1">
            <div class="ethport"> 00:22:22:22:22:01</div>
            <div class="ip4port">192.168.2.100</div>
        </div>
    </div>
</div>

<div id="formip4"></div>
<div id="formether"></div>

</body>
</html>
