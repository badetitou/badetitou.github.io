<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="Benoît Verhaeghe's blog">
    

    <link rel="icon" href="/img/logo/logo.png" type="image/x-icon">


    <title>VSCode-Pharo with GTK support - Benoît Verhaeghe</title>

    <link rel="canonical" href="http://badetitou.github.io/projects/vscode-pharo/2021/12/02/with-gtk/">

    <!-- <link rel="stylesheet" href="/assets/vendor/fontawesome-free/css/all.min.css"> -->
    
    <script src="https://kit.fontawesome.com/5574707d0b.js" crossorigin="anonymous"></script>
    
    <!-- My CSS -->
    <link rel="stylesheet" href="/assets/main.css">
    <!-- My JS -->
    <script src="/js/my-head.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link type="application/atom+xml" rel="alternate" href="http://badetitou.github.io/feed.xml" title="Benoît Verhaeghe" />

</head>


<body>

    <nav>
    <div class="nav-wrapper">
        <a href="#" onclick="openNav()" class="sidenav-trigger"><i class="material-icons">menu</i></a>
        
        <ul class="left hide-on-med-and-down"> <li>
        <a href="/" style="margin-left: 20px;"> Benoît Verhaeghe</a>
</li>
</ul>

        <ul class="right hide-on-med-and-down">
            <li>
                <span style="width: 30px; display: inline-block;">
                    <i id="theme-switch" style="font-size: 20px" class="fa-solid fa-1x"></i>
                </span>
            </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
            <li><a href="/teaching/">Teaching</a></li>
        
        
        
        
        
        
        
        
        
            <li><a href="/post/">Posts</a></li>
        
        
        
        
        
        
        
        
        
            <li><a href="/projects/">Projects</a></li>
        
        
        
            <li><a href="/research/">Research</a></li>
        
        
        
        
        
        </ul>
        
    </div>
</nav>

<ul class="sidenav" id="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
    <li><a href="/">Home</a></li>
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
            <li><a href="/teaching/">Teaching</a></li>
        
    
        
        
    
        
        
    
        
            <li><a href="/post/">Posts</a></li>
        
    
        
        
    
        
        
    
        
            <li><a href="/projects/">Projects</a></li>
        
    
        
            <li><a href="/research/">Research</a></li>
        
    
        
        
    
</ul>

<div id="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12">
                <div class="post-heading text-center">
                    <h1>VSCode-Pharo with GTK support</h1>
                    
                    <span class="meta">Posted by
                        Benoît "badetitou" Verhaeghe on
                        December 2, 2021</span>
                    <span class="post-meta">
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article class="container">
    <div class="row">
        <div class="col s12 m12">
            <div class="card">
                <div class="card-content article-content">
                    <p>I spent this year writing my Ph.D., obtaining it, migrating several applications <a href="https://berger-levrault.com">@Berger-Levrault</a>, and… Playing with VSCode and Pharo <img class="emoji" title=":joy:" alt=":joy:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png" height="20" width="20"></p>

<p>When I started the project of connecting VSCode with Pharo, I wanted language support and basic debugging functions.
Then, I talked to friends, and I decided to implement the support of <a href="https://code.visualstudio.com/api/extension-guides/notebook">Notebook</a>.</p>

<p>Ok… We did more than expected… So, what is the next step?
Why not use the UI of Pharo for specific actions I need when developing an app from VSCode?</p>

<ul>
  <li>
<a href="#for-users">For Users</a>
    <ul>
      <li><a href="#install-pharo-language-plugin">Install Pharo Language Plugin</a></li>
      <li><a href="#configure-the-plugin">Configure the plugin</a></li>
      <li><a href="#analyse-with-moosebook">Analyse with Moosebook</a></li>
    </ul>
  </li>
  <li><a href="#for-developers">For developers</a></li>
</ul>

<h2 id="for-users">For Users</h2>

<h3 id="install-pharo-language-plugin">Install Pharo Language Plugin</h3>

<p>The installation of the Pharo Language plugin is straightforward.
Once you have installed <a href="https://code.visualstudio.com/">VSCode</a>, go to the extension panel, search for Pharo, select <code class="language-plaintext highlighter-rouge">Pharo Language Support</code>, and install the extension.</p>

<h3 id="configure-the-plugin">Configure the plugin</h3>

<p>Three steps are required to set up the plugin.</p>

<ol>
  <li>Install a Pharo Image with the Pharo LanguageServer project installed. You can find a pre-built image in my <a href="https://github.com/badetitou/Pharo-LanguageServer/releases">GitHub repository</a>.</li>
  <li>Download a corresponding VM.
    <blockquote>
      <p>Since we are going to use GTK backend. The VM installation requires more steps in Windows. Please, refer to the GTK backend project to download a VM <a href="https://github.com/pharo-spec/Spec-Gtk#on-windows">in window</a></p>
    </blockquote>
  </li>
  <li>In VSCode settings, update the <code class="language-plaintext highlighter-rouge">path to image</code> and <code class="language-plaintext highlighter-rouge">path to vm</code> according to the downloaded files.</li>
</ol>

<h3 id="analyse-with-moosebook">Analyse with Moosebook</h3>

<p>Once everything is configured, it is possible to use VSCode to perform any analysis within a notebook.
To do so, first, create a new file in VSCode that ends with the <code class="language-plaintext highlighter-rouge">.moosebook</code> extension.</p>

<blockquote>
  <p>I use <code class="language-plaintext highlighter-rouge">moosebook</code> as an extension because I am first a <a href="https://modularmoose.org">Moose developer</a>, and I use this plugin to analyze software systems from VSCode.</p>
</blockquote>

<p>A notebook appears in which you can add markdown and Pharo cells.
Write some Pharo code (for example, <code class="language-plaintext highlighter-rouge">1+1</code>) and execute it.
Pharo executes the code in the backend server, and the result is displayed in the result part of the notebook cell.</p>

<p><em>OK, it is nice, but I want a GTK backend…</em></p>

<p>Using the GTK backend to visualize the result is super easy, you have to select the code you want to execute, then right-click, and you can perform <code class="language-plaintext highlighter-rouge">Show the result of selected lines</code>.
The result will be shown in a GTK window containing the Pharo Inspector.
From this window, you can explore the object, have a look at Roassal visualization, <em>etc.</em></p>

<p>Several <a href="https://github.com/ObjectProfile/Roassal3#quick-examples">demo visualisations exist for Roassal</a>.
You only have to remove the <code class="language-plaintext highlighter-rouge">open</code> keyword at the end of each example.</p>

<h2 id="for-developers">For developers</h2>

<p>I created the VSCode extension using the <a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol (LSP)</a>.
It allows one to add support for its language across several tools such as VSCode, Vim, Eclipse, <em>etc.</em></p>

<p>I wanted to add other nice features to improve the external tools with super cool Pharo features such as the Inspector.
But… How to benefit from most of the greatest Pharo features without the UI already existing in Pharo.
I mean… I do not want to redevelop an inspector in VSCode and other IDEs, but I still want to see if it is possible to offer it to my plugin.</p>

<p>So, instead of redeveloping the UI, I decided to bring the Pharo UI as an extension of the developers’ IDE.
Since embedding the Pharo Image UI inside the editor looks bad to me, I decided to use the <a href="https://github.com/pharo-spec/Spec-Gtk">Spec-Gtk backend project</a>.</p>

<p>This project allows one to run Spec UI using the GTK binding.
To use it, I needed to load the project when loading the Pharo Language Server (PLS) project.
So I added GTK binding project in the PLS baseline.</p>

<p>Then, I added to the default LSP a new command that takes as a parameter a string (the selected lines of code), executes it, and inspects it using the GTK backend.</p>

<p>Thus, when a user performs <code class="language-plaintext highlighter-rouge">Show the result of selected lines</code>, the PLS plugin sends a specific command to the pharo language server backend, that in turn executes the code and opens the GTK backend.</p>

                </div>
            </div>
        </div>
    </div>

    <script src="https://utteranc.es/client.js" repo="badetitou/badetitou.github.io" issue-term="pathname" label="comments" theme="boxy-light" crossorigin="anonymous" async>
</script>

    <ul class="pager list-inline">
        
        <li class="previous">
            <a class="m-button" href="/misc/2021/10/01/migrating-internationalization/" data-toggle="tooltip" data-placement="top" data-tooltip="Migrating internationalization files">←
                Previous Post</a>
        </li>
        
        
        <li class="next">
            <a class="m-button" href="/misc/2022/05/16/Casino-a-tool-to-migrate-application/" data-toggle="tooltip" data-placement="top" data-tooltip="Casino, a tool to migrate applications">Next Post →</a>
        </li>
        
    </ul>
</article>


    <!-- Footer -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col m12">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href="https://twitter.com/badetitou">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a rel="me" href="https://piaille.fr/@badetitou">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://orcid.org/0000-0002-4588-2698">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-orcid fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/badetitou">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.linkedin.com/in/benoitverhaeghe">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-linkedin-in fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:benoit@badetitou.fr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="text-center">Copyright © badetitou 2023
                </p>
            </div>
        </div>
    </div>
</footer>

    <!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<script src="/js/my.js"></script>
<script src="/js/my-sidenav.js"></script>

<script src="/js/lightense.min.js"></script>

<script>

  // Init Lightense
  window.addEventListener("load", function() {
    Lightense("img:not(.no-lightense),.lightense", {
      background: 'rgba(0,0,0,0.05)'
    });
  }, false);

  // Example: Lazy Lightense
  document.addEventListener("DOMContentLoaded", function(e) {
    function createDom(type, cssClass) {
      var div = document.createElement(type);
      div.className = cssClass;
      return div;
    }

    var thumb = document.querySelector(".lightense-lazy");
    var original = new Image();

    // Init wrapper
    var wrap = createDom("div", "lightense-lazy-wrap");
    thumb.parentNode.insertBefore(wrap, thumb);
    wrap.appendChild(thumb);

    // Wrap thumbnail
    var thumbWrap = createDom("div", "lightense-lazy-thumb");
    thumbWrap.appendChild(thumb);
    wrap.appendChild(thumbWrap);

    // Wrap original
    var originalWrap = createDom("div", "lightense-lazy-large");
    original.src = thumb.dataset.original;
    originalWrap.appendChild(original);
    wrap.appendChild(originalWrap);

    // Load original image
    original.addEventListener(
      "load",
      function() {
        wrap.classList.add("on");
      },
      false
    );
  });
</script>


</body>

</html>
